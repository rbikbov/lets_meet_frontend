import{a$ as h,r as D,N as y,O as _,P as k,c as A,Q as g,R as o,U as d,B as l,ap as S,S as s,V as x,aY as B,M as C,W as I}from"./index.be0786c9.js";import{u as L,D as N}from"./keys.abfa1cc6.js";import{f as F}from"./dialogs.daa209f3.js";import{d as U}from"./defaultAvatar.ec510896.js";import{g as b}from"./fullName.61125800.js";import{V as O}from"./VContainer.0d9e09c0.js";import{g as Q,s as R,e as T}from"./VAvatar.75e0fa98.js";import{a as $,V as q}from"./VList.20eb48c9.js";import"./VProgressCircular.6cfce55a.js";import"./index.5baaf378.js";import"./VDivider.373e3431.js";const v=h("dialogs",()=>{const c=D([]);function i(m){c.value=m}return{dialogs:c,setDialogs:i}}),J=y({__name:"DialogsList",setup(c){const{dialogs:i}=_(v()),{setDialogs:m}=v(),{user:n}=_(k()),V=L({queryKey:[N],queryFn:()=>{var e;return F((e=n.value)==null?void 0:e.id)},onSuccess:e=>{m(e.data)}}),f=A(()=>n.value?i.value.reduce((e,a)=>{var r;const t=a.incoming_id===((r=n.value)==null?void 0:r.id)?a.outgoing_id:a.incoming_id;return e[a.id]=a.users.find(u=>u.id===t),e},{}):{});return(e,a)=>(d(),g(O,{fluid:""},{default:o(()=>[l(Q,{class:"mx-auto",color:"success",type:"button",variant:"elevated",onClick:s(V).refetch},{default:o(()=>[S(" Fetch dialogs ")]),_:1},8,["onClick"]),l($,{lines:"three"},{default:o(()=>[(d(!0),x(C,null,B(s(i),t=>{var r,u,p;return d(),g(q,{key:t.id,title:s(b)(s(f)[t.id]),subtitle:`${((r=t.last_message)==null?void 0:r.user_id)===((u=s(n))==null?void 0:u.id)?"You: ":""}${((p=t.last_message)==null?void 0:p.description)||"..."}`,to:{name:s(I).dialogDetail,params:{id:t.id}}},{prepend:o(()=>[l(R,{size:80},{default:o(()=>[l(T,{alt:"Avatar",src:s(f)[t.id].avatar||s(U)},null,8,["src"])]),_:2},1024)]),_:2},1032,["title","subtitle","to"])}),128))]),_:1})]),_:1}))}});export{J as default};
